<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>DPOS - TRON Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "DPOS";
    var mkdocs_page_input_path = "introduction/dpos.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> TRON Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">Introduction</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../">Repository</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">DPOS</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#overview">Overview</a></li>
    

    <li class="toctree-l3"><a href="#bookkeeping-process">Bookkeeping process</a></li>
    

    <li class="toctree-l3"><a href="#dpos-overview">DPOS overview</a></li>
    

    <li class="toctree-l3"><a href="#definition">Definition</a></li>
    

    <li class="toctree-l3"><a href="#election-mechanism">Election mechanism</a></li>
    

    <li class="toctree-l3"><a href="#block-generation-mechanism">Block generation mechanism</a></li>
    

    <li class="toctree-l3"><a href="#incentive-model">Incentive model</a></li>
    

    <li class="toctree-l3"><a href="#proposal-based-parameter-adjustment">Proposal-based parameter adjustment</a></li>
    

    <li class="toctree-l3"><a href="#bandwidth-and-energy-mechanism">Bandwidth and energy mechanism</a></li>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">API</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../api/http/">Http Api</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/rpc/">Rpc Api</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Mechanism & Algorithm</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../mechanism&algorithm/sr/">SR and Committee</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism&algorithm/trc10/">TRC-10</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism&algorithm/account/">Account Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism&algorithm/resource/">Resource Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism&algorithm/dex/">DEX</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism&algorithm/multi-signatures/">Multi Signatures</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism&algorithm/shielded-transaction/">Shielded Transaction</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Architecture</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../architecture/network/">Network</a>
                </li>
                <li class="">
                    
    <a class="" href="../../architecture/database/">Database</a>
                </li>
                <li class="">
                    
    <a class="" href="../../architecture/plugin/">Plugin</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Contracts</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../contracts/tvm/">TVM</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contracts/compiler/">Compiler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contracts/contract/">Contract</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developers</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../developers/official-public-nodes/">Official Public Nodes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/deployment/">Deployment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/resources/">Resources</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/contribution/">Contribution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/incentives/">Incentives Policy</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Clients</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../clients/wallet-cli/">Wallet-cli</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../q&a/qa/">Q&A</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">TRON Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Introduction &raquo;</li>
        
      
    
    <li>DPOS</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="overview">Overview</h2>
<p>Blockchain is a distributed bookkeeping system. There can be thousands of nodes in a blockchain system. Each of them independently stores the same ledger. For new transaction data to be written into the ledger, approvals from these nodes are needed. Achieving this goal in an untrusted distributed environment is a systematic, complicated quest. For a blockchain system to operate normally, that is, each node in the blockchain can always keep the same ledger, an absolute majority of the nodes in the system have to be honest and reliable. In order to ensure that honest and reliable nodes can jointly supervise the process of transaction data being written into the ledgers, each blockchain system needs to build its own consensus, which is equivalent to a constitution on the blockchain. Consensus guarantees that even in an untrusted distributed environment, as long as the vast majority of nodes comply with the consensus requirements, the results will certainly be credible. Therefore, the significance of the consensus is that the honest nodes in the blockchain can ultimately achieve the agreement of the ledgers as long as they strictly abide by this consensus.</p>
<p>There are several types of consensus, and the most used ones are POW, POS, and DPOS. Of course, different blockchain systems will have their own unique way of implementation. The article will mainly introduce the DPOS consensus on which TRON bases itself. We will also explain the basic components and mechanism of DPOS.</p>
<h2 id="bookkeeping-process">Bookkeeping process</h2>
<p>The bookkeeper of the blockchain system collects the newly generated transactions in the blockchain network and verifies the legality of these transactions, then packages the transactions in a block, records them as a new page on the ledger, and broadcasts the page to the entire blockchain network. Other nodes will receive the new page and verify the legality of the transaction data on the page and add it to their own ledger. The bookkeeper will repeat this process so all new transaction data in the blockchain system can be recorded in the ledger.</p>
<h2 id="dpos-overview">DPOS overview</h2>
<p>The role of consensus is to select the bookkeepers in the blockchain system. The bookkeepers verify the transaction data and keep the account in order to broadcast new accounts to other nodes in the network and obtains the approval of the new accounts from other nodes. As a specific implementation of consensus, DPOS works in the following way:</p>
<p>The DPOS consensus selects some nodes as bookkeepers in the blockchain system based on the number of votes they receive. First, when the blockchain system starts to operate, a certain number of tokens will be issued, and then the tokens will be given to nodes in the blockchain system. A node can apply to be a bookkeeper candidate in the blockchain system with a portion of the tokens. Any token-holding node in the blockchain system can vote for these candidates. Every t period of time, the votes for all the candidates will be counted. Top N candidate nodes with the most votes will become bookkeepers for the next t period. After t period of time, the votes will be counted again to elect the new bookkeepers, and the cycle continues.</p>
<p>Let's see how it's realized in the context of TRON:</p>
<h2 id="definition">Definition</h2>
<p>TRON: refers to the TRON network. The document does not distinguish between TRON, TRON blockchain, TRON blockchain system, etc.</p>
<p>TRON token: refers to the equity token issued by and circulating in TRON, known as TRX.</p>
<p>Bookkeeper candidates: nodes eligible for becoming bookkeepers in TRON.</p>
<p>Bookkeeper: nodes in TRON qualified for bookkeeping. They are usually called witness in DPOS consensus. In TRON, the 27 bookkeepers are also called super nodes (or SR). We will not distinguish between bookkeeper, witness, supernode, SR, etc.</p>
<p>Bookkeeping: the process of verifying transactions and recording them in a ledger. Because ledgers in TRON are carried by blocks, the bookkeeping process is also called block generation. We will not distinguish between bookkeeping and block generation in the document.</p>
<p>Bookkeeping order: block generation order. The descending order of the 27 bookkeepers based on the number of votes they receive.</p>
<p>Block time: TRON sets block time to be 3 seconds. This means a block is generated every 3 seconds.</p>
<p>Slot: after each block is generated, it can be put into a slot; and each generated block will take up a slot. For example, there are 20 slots for every minute. When a block is generated during the block time, the corresponding slot will be filled. If a block is not generated, then the corresponding slot will be empty. The next block generated will fill in a new corresponding slot.</p>
<p>Epoch: TRON sets an Epoch to be 6 hours. The last 2 block time of an Epoch is the maintenance period, during which block generating order for the next Epoch will be decided.</p>
<p>The maintenance period: TRON sets the period to be 2 block time, which is 6 seconds. This period of time is used to count the votes for candidates. There are 4 Epoch in 24 hours, and naturally, 4 maintenance periods. During the maintenance period, no block is generated and block generation order for the next Epoch is decided.</p>
<p><img alt="image" src="https://raw.githubusercontent.com/tronprotocol/documentation-EN/master/imags/sequence.png" /></p>
<h2 id="election-mechanism">Election mechanism</h2>
<ol>
<li>Votes</li>
</ol>
<p>In TRON, 1 TRX equals 1 vote.</p>
<ol>
<li>Voting process</li>
</ol>
<p>In TRON, voting for candidates is a special transaction. Nodes can vote for candidates through generating a voting transaction.</p>
<ol>
<li>Vote counting</li>
</ol>
<p>During each maintenance period, the votes for candidates will be counted. The top 27 candidates with the most votes will be the bookkeepers for the next Epoch.</p>
<h2 id="block-generation-mechanism">Block generation mechanism</h2>
<p>During each Epoch, the 27 bookkeepers will take turns to generate blocks according to the bookkeeping order. Each bookkeeper can only generate blocks when it is their turn. Bookkeepers package the data of multiple verified transactions into each block. The hash of the previous block will be included into each new block as the parentHash. The bookkeeper will sign the data of this block with his/her private key and fill in witness_signature, along with the address of the keeper, the block height, and the time the block is generated, etc.</p>
<p>Through storing the hash of the previous block, blocks are logically connected. Eventually, they form a chain. A typical blockchain structure is shown in the following picture:</p>
<p><img alt="image" src="https://raw.githubusercontent.com/tronprotocol/documentation-EN/master/imags/blockchain_structure.png" /></p>
<p>In ideal circumstances, the bookkeeping process in a DPOS consensus-based blockchain system proceeds according to the bookkeeping order calculated in advance. Blocks are generated by witnesses in turn (see figure a). However, in reality, the blockchain network is a distributed and untrusted complex system in the following three ways. Firstly, due to poor network environment, blocks generated by witnesses cannot be received by other witnesses in valid time (see figure b1 and b2). Secondly, the normal operation of a certain witness cannot always be guaranteed (see figure c). Thirdly, some malicious witnesses will generate fork blocks in order to fork the chain (see figure d).</p>
<p><img alt="image" src="https://raw.githubusercontent.com/tronprotocol/documentation-EN/master/imags/longest_chain1.png" /></p>
<p><img alt="image" src="https://raw.githubusercontent.com/tronprotocol/documentation-EN/master/imags/longest_chain2.png" /></p>
<p>As mentioned above, the basis for the blockchain system to operate normally is that most of the nodes in the system are honest and reliable. Furthermore, the primary guarantee for the security of the blockchain system is the security of the ledger, meaning that illegal data cannot be written into the ledger maliciously and ledger copies saved on each node should be consistent as well. Based on DPOS consensus, the bookkeeping process is carried out by witnesses. Therefore, the safety of TRON depends on the reliability of the majority of the witnesses. TRON has put confirmed blocks in the system which are irreversible. At the same time, in order to resist the malicious behaviors of a small number of bookkeeping nodes, TRON recognize the longest chain as the main chain based on "the longest chain principle".</p>
<p>The confirmed block principle</p>
<p>A block "approved" by more than two thirds of the 27 witnesses (27 * 2/3 + 1 = 19) is called a confirmed block, meaning that the transaction data in this block is confirmed by the entire TRON blockchain. "Approved" means that the block produced by the witness follows the approval-pending block. For example, block No.103 in figure d is produced by witness C; Witness E produced block No.104 after No.103. Then No. 105, 106, 107 produced by witness G, A, B are all following blocks that come after block No.103, making them the approval blocks for block No. 103 by witness C.</p>
<p>The longest chain principle</p>
<p>When a fork occurs, an honest witness would always choose to produce blocks on the longest chain.</p>
<h2 id="incentive-model">Incentive model</h2>
<p>To ensure safe and efficient operation of the blockchain system, TRON sets up an incentive model to encourage node participation and network expansion. Bookkeepers who complete block production tasks will be rewarded with TRX. The model also specifies that for every confirmed block produced by a witness, the witness will receive 32 TRX; For the first 127th witnesses (including bookkeeper candidates) with the most votes, they will receive proportional rewards during the maintenance period of each Epoch.</p>
<h2 id="proposal-based-parameter-adjustment">Proposal-based parameter adjustment</h2>
<p>One important characteristics of DPOS is that any parameter adjustment can be proposed on the chain, and bookkeepers will decide whether to approve the proposal by starting a vote. A benefit to this method is that it avoids hard fork upgrades when adding new features. Currently, TRON supports the following parameter adjustments:</p>
<ol>
<li>
<p>The interval between two maintenance periods</p>
</li>
<li>
<p>The TRX cost of applying to be a bookkeeper candidate.</p>
</li>
<li>
<p>The TRX cost of account activation</p>
</li>
<li>
<p>The bandwidth cost for one byte in each transaction</p>
</li>
<li>
<p>The TRX cost of issuing tokens on TRON</p>
</li>
<li>
<p>The rewards for producing each block</p>
</li>
<li>
<p>The total amount of TRX that is proportionately awarded to the first 127th bookkeepers (including bookkeeper candidates) with the most votes</p>
</li>
<li>
<p>The TRX cost of account activation through system contract</p>
</li>
<li>
<p>The bandwidth cost for account activation</p>
</li>
<li>
<p>The exchange rate between Energy and Sun</p>
</li>
<li>
<p>The TRX cost for building a TRC-10 token-based decentralized trading pair</p>
</li>
<li>
<p>The maximum CPU time allowed for a single transaction execution</p>
</li>
<li>
<p>Whether to allow changes of account names</p>
</li>
<li>
<p>Whether to allow the issuance of assets with duplicate names</p>
</li>
<li>
<p>Whether to allow resource delegation</p>
</li>
<li>
<p>The upper limit for Energy in TRON blockchain</p>
</li>
<li>
<p>Whether to allow TRC-10 asset transfer in smart contracts</p>
</li>
<li>
<p>Whether to allow adjustment to Energy upper limit</p>
</li>
<li>
<p>Whether to allow multi-signature</p>
</li>
<li>
<p>The TRX cost of updating account access</p>
</li>
<li>
<p>The TRX cost of multi-signature transactions</p>
</li>
<li>
<p>Whether to verify block and transaction protobuf message</p>
</li>
</ol>
<h2 id="bandwidth-and-energy-mechanism">Bandwidth and energy mechanism</h2>
<p>To be continued</p>
<p>Appendix: Reference Documentations</p>
<p><a href="https://www.coinbureau.com/education/delegated-proof-stake-dpos/">https://www.coinbureau.com/education/delegated-proof-stake-dpos/</a>  </p>
<p><a href="https://www.nichanank.com/blog/2018/6/4/consensus-algorithms-pos-dpos">https://www.nichanank.com/blog/2018/6/4/consensus-algorithms-pos-dpos</a>  </p>
<p><a href="http://docs.bitshares.org/en/master/technology/dpos.html#role-of-delegates">http://docs.bitshares.org/en/master/technology/dpos.html#role-of-delegates</a>  </p>
<p><a href="https://hackernoon.com/what-is-delegated-proof-of-stake-897a2f0558f9">https://hackernoon.com/what-is-delegated-proof-of-stake-897a2f0558f9</a>   </p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../api/http/" class="btn btn-neutral float-right" title="Http Api">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../" class="btn btn-neutral" title="Repository"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../api/http/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
